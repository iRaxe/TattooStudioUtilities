import{r,g as _,j as e,I as B}from"./index-CFS5meP2.js";import{F as T}from"./InformationCircleIcon-DF1m2Q78.js";function A({title:l,titleId:m,...p},o){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":m},p),l?r.createElement("title",{id:m},l):null,r.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25ZM12.75 6a.75.75 0 0 0-1.5 0v6c0 .414.336.75.75.75h4.5a.75.75 0 0 0 0-1.5h-3.75V6Z",clipRule:"evenodd"}))}const E=r.forwardRef(A);function I({onSlotSelect:l,tatuatori:m,stanze:p}){const[o,j]=r.useState(new Date().toISOString().split("T")[0]),[s,y]=r.useState(""),[d,S]=r.useState(""),[g,z]=r.useState(60),[a,k]=r.useState(null),[c,h]=r.useState(!1),[b,v]=r.useState(""),f={width:"100%",padding:"0.75rem",backgroundColor:"#000000",border:"1px solid rgba(255, 255, 255, 0.12)",borderRadius:"6px",color:"#f3f4f6",fontSize:"0.9rem"};r.useEffect(()=>{s&&d&&o&&w()},[s,d,o,g]);const w=async()=>{try{h(!0),v("");const i=_("adminToken"),n=await fetch(`/api/admin/disponibilita?tatuatore_id=${s}&stanza_id=${d}&data=${o}&durata_minuti=${g}`,{headers:{Authorization:`Bearer ${i}`}});if(!n.ok)throw new Error("Errore nel recupero disponibilità");const t=await n.json();k(t)}catch(i){console.error("Errore nel caricamento disponibilità:",i),v("Errore nel caricamento della disponibilità")}finally{h(!1)}},D=i=>{i.disponibile&&(l==null||l(i.orario_inizio,g))},C=i=>{if(!i.disponibile)return{background:"rgba(239, 68, 68, 0.2)",border:"1px solid rgba(239, 68, 68, 0.5)",color:"#fca5a5"};const n=new Date,t=new Date(i.orario_inizio);return n>=t&&n<new Date(i.orario_fine)?{background:"rgba(245, 158, 11, 0.3)",border:"2px solid rgba(245, 158, 11, 0.7)",color:"#fbbf24"}:{background:"rgba(34, 197, 94, 0.1)",border:"1px solid rgba(34, 197, 94, 0.3)",color:"#4ade80",cursor:"pointer"}},R=i=>new Date(i).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),u=m.find(i=>i.id===s),x=p.find(i=>i.id===d);return e.jsxs("div",{children:[e.jsxs("h3",{className:"section-title",children:[e.jsx(E,{className:"section-title-icon","aria-hidden":"true"})," Verifica Disponibilità"]}),e.jsx("p",{className:"section-description",children:"Controlla la disponibilità in tempo reale e seleziona slot per creare appuntamenti"}),e.jsxs("div",{style:{display:"grid",gap:"1rem",marginBottom:"2rem",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fbbf24",fontSize:"0.9rem",fontWeight:"600",display:"block",marginBottom:"0.5rem"},children:"Data *"}),e.jsx(B,{type:"date",value:o,onChange:i=>j(i.target.value),min:new Date().toISOString().split("T")[0],disabled:c})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fbbf24",fontSize:"0.9rem",fontWeight:"600",display:"block",marginBottom:"0.5rem"},children:"Tatuatore *"}),e.jsxs("select",{value:s,onChange:i=>y(i.target.value),style:f,disabled:c,children:[e.jsx("option",{value:"",children:"Seleziona tatuatore..."}),m.map(i=>e.jsxs("option",{value:i.id,children:[i.nome," ",i.attivo?"":"(Disattivo)"]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fbbf24",fontSize:"0.9rem",fontWeight:"600",display:"block",marginBottom:"0.5rem"},children:"Stanza *"}),e.jsxs("select",{value:d,onChange:i=>S(i.target.value),style:f,disabled:c,children:[e.jsx("option",{value:"",children:"Seleziona stanza..."}),p.map(i=>e.jsxs("option",{value:i.id,children:[i.nome," ",i.no_overbooking?"(No Overbooking)":"",i.attivo?"":" (Disattiva)"]},i.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{color:"#fbbf24",fontSize:"0.9rem",fontWeight:"600",display:"block",marginBottom:"0.5rem"},children:"Durata Appuntamento"}),e.jsxs("select",{value:g,onChange:i=>z(parseInt(i.target.value)),style:f,disabled:c,children:[e.jsx("option",{value:15,children:"15 minuti"}),e.jsx("option",{value:30,children:"30 minuti"}),e.jsx("option",{value:60,children:"1 ora"}),e.jsx("option",{value:90,children:"1 ora 30 min"}),e.jsx("option",{value:120,children:"2 ore"}),e.jsx("option",{value:180,children:"3 ore"})]})]})]}),c&&e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af"},children:[e.jsx("div",{style:{fontSize:"1.5rem",marginBottom:"0.5rem",fontWeight:600},children:"Verifica disponibilità in corso"}),"Stiamo recuperando gli slot disponibili, attendi qualche istante."]}),b&&e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#ef4444",background:"rgba(239, 68, 68, 0.1)",borderRadius:"4px",border:"1px solid rgba(239, 68, 68, 0.3)"},children:[e.jsx("div",{style:{fontSize:"1.5rem",marginBottom:"0.5rem",fontWeight:600},children:"Si è verificato un errore"}),b]}),a&&!c&&!b&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"1rem",marginBottom:"2rem"},children:[e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#22c55e",marginBottom:"0.5rem"},children:a.slots_disponibili}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"0.9rem"},children:"Slot Disponibili"})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",padding:"1rem",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#fbbf24",marginBottom:"0.5rem"},children:a.total_slots}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"0.9rem"},children:"Slot Totali"})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",padding:"1rem",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"2rem",fontWeight:"bold",color:"#f59e0b",marginBottom:"0.5rem"},children:[Math.round(a.slots_disponibili/a.total_slots*100),"%"]}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"0.9rem"},children:"Disponibilità"})]}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.05)",border:"1px solid rgba(255, 255, 255, 0.1)",borderRadius:"4px",padding:"1rem",textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:"1.2rem",fontWeight:"bold",color:"#fbbf24",marginBottom:"0.5rem"},children:[u==null?void 0:u.nome," - ",x==null?void 0:x.nome]}),e.jsx("div",{style:{color:"#9ca3af",fontSize:"0.8rem"},children:new Date(o).toLocaleDateString("it-IT",{weekday:"long",day:"numeric",month:"long"})})]})]}),e.jsx("div",{style:{background:"rgba(255, 255, 255, 0.05)",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.1)",overflow:"hidden"},children:e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(120px, 1fr))",gap:"0.5rem",padding:"1rem"},children:a.slots.map((i,n)=>e.jsxs("div",{onClick:()=>D(i),style:{...C(i),borderRadius:"4px",padding:"0.75rem",textAlign:"center",transition:"all 0.2s ease",position:"relative"},onMouseEnter:t=>{i.disponibile&&(t.target.style.transform="scale(1.05)",t.target.style.boxShadow="0 4px 12px rgba(0, 0, 0, 0.3)")},onMouseLeave:t=>{t.target.style.transform="scale(1)",t.target.style.boxShadow="none"},children:[e.jsx("div",{style:{fontSize:"0.9rem",fontWeight:"600"},children:R(i.orario_inizio)}),e.jsx("div",{style:{fontSize:"0.8rem",marginTop:"0.25rem"},children:i.disponibile?"Disponibile":"Occupato"}),i.conflicts&&i.conflicts.length>0&&e.jsx("div",{style:{position:"absolute",top:"-5px",right:"-5px",width:"12px",height:"12px",background:"#f59e0b",borderRadius:"50%",border:"2px solid rgba(255, 255, 255, 0.2)"},title:`Conflitto: ${i.conflicts.map(t=>t.tatuatore_nome).join(", ")}`})]},n))})}),a.slots.length>0&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"rgba(255, 255, 255, 0.02)",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.05)"},children:[e.jsxs("h4",{style:{color:"#fbbf24",marginBottom:"0.5rem",fontSize:"1rem",display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx(T,{className:"icon-inline icon-no-margin","aria-hidden":"true"}),"Dettagli Slot"]}),e.jsxs("div",{style:{fontSize:"0.9rem",color:"#9ca3af"},children:["Orario lavorativo: 09:00 - 21:00 • Slot: 15 minuti • Durata selezionata: ",g," minuti"]})]})]}),!s||!d||!o?e.jsxs("div",{style:{textAlign:"center",padding:"3rem",color:"#9ca3af",background:"rgba(255, 255, 255, 0.05)",borderRadius:"4px",border:"1px solid rgba(255, 255, 255, 0.1)"},children:[e.jsx("h4",{style:{color:"#f3f4f6",marginBottom:"0.75rem",fontSize:"1.1rem"},children:"Seleziona parametri"}),e.jsx("p",{style:{margin:0,fontSize:"0.9rem"},children:"Seleziona tatuatore, stanza e data per visualizzare la disponibilità"})]}):null]})}const $=Object.freeze(Object.defineProperty({__proto__:null,default:I},Symbol.toStringTag,{value:"Module"}));export{I as A,E as F,$ as a};
